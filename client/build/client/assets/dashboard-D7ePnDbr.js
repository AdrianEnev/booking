import{w as u}from"./with-props-6HJavTuU.js";import{o as e,p as h,a as p}from"./chunk-AYJ5UCUI-Bkv6Ioix.js";import{u as f}from"./GlobalContext-DI10b9EF.js";import{s as g}from"./useStandardizeDate-DE6U8t9S.js";import{s as j}from"./useStandardizeService-C0larYo8.js";import{f as b}from"./useFetchAppointments-DsUODtBA.js";function N({appointment:t}){return e.jsxs("div",{className:"grid grid-cols-7 text-center",children:[e.jsx("p",{children:g(t.appointmentDate)}),e.jsx("p",{children:t.customerEmail||"-"}),e.jsx("p",{children:t.customerName||"-"}),e.jsx("p",{children:t.customerPhone||"-"}),e.jsx("p",{children:t.note||"-"}),e.jsx("p",{children:j(t.service)||"-"}),e.jsx("p",{children:t.hour||"-"})]})}function y({appointments:t,setAppointments:o,getAppointments:c,setLoading:s,retreivingAppointments:i}){return e.jsxs("div",{className:"flex flex-col gap-y-6 mt-4 border border-gray-200 rounded-xl px-4 pt-4 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-7 text-center text-xl font-bold",children:[e.jsx("p",{children:"Дата"}),e.jsx("p",{children:"Имейл"}),e.jsx("p",{children:"Име"}),e.jsx("p",{children:"Телефон"}),e.jsx("p",{children:"Бележка"}),e.jsx("p",{children:"Услуга"}),e.jsx("p",{children:"Час"})]}),e.jsx("div",{className:"overflow-y-auto max-h-128 flex flex-col gap-y-3 border border-gray-200 rounded-xl py-4",children:t&&t.length===0&&!i?e.jsx("div",{className:"w-full h-full z-20 flex justify-center items-center",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"Няма намерени часове"})}):t&&t.length===0&&i?e.jsx("div",{className:"w-full h-full z-20 flex justify-center items-center",children:e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-red-500"})})}):t.map(r=>e.jsx(N,{appointment:r},r.id))}),e.jsxs("div",{className:"w-full h-12",children:[e.jsxs("button",{className:"flex flex-row gap-x-2",children:[e.jsx("p",{className:"text-gray-500 text-sm mt-[-2px] mb-[2px]",children:"Днес"}),e.jsx("input",{type:"checkbox",className:"w-4 h-4 border border-gray-300 rounded-lg",onChange:async r=>{if(!r.target.checked){s(!0),await c(),s(!1);return}const n=new Date,l=t.filter(m=>{const a=new Date(m.appointmentDate);return a.getDate()===n.getDate()&&a.getMonth()===n.getMonth()&&a.getFullYear()===n.getFullYear()});o(l)}})]}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["Общо: ",t.length," поръчки"]})]})]})}function w(t){return[...t].sort((o,c)=>{const s=new Date,i=new Date(o.appointmentDate),r=new Date(c.appointmentDate),d=i.toDateString()===s.toDateString(),n=r.toDateString()===s.toDateString();if(d&&!n)return-1;if(!d&&n)return 1;const l=Math.abs(i.getTime()-s.getTime())-Math.abs(r.getTime()-s.getTime());if(l!==0)return l;const m=o.hour.split(":").map(Number),a=c.hour.split(":").map(Number),x=m[0]*60+m[1];return a[0]*60+a[1]-x})}const k=u(function(){const{setLoading:o,retrievingAppointments:c,setRetrievingAppointments:s,isAdmin:i}=f(),r=h(),[d,n]=p.useState([]);p.useEffect(()=>{if(!i){r("/");return}l()},[]);const l=async()=>{s(!0);const a=(await b()).filter(x=>x.status==="confirmed");n(a),s(!1)};return e.jsxs("div",{className:"w-full h-full font-manrope px-12",children:[e.jsx("p",{className:"text-3xl text-black mt-5 font-semibold",children:"Дашборд"}),e.jsx("div",{className:"w-full h-[2px] bg-gray-100 rounded-full mt-2"}),e.jsx("h1",{className:"text-xl font-semibold mt-2",children:"Поръчки"}),e.jsx(y,{appointments:w(d),setAppointments:n,getAppointments:l,setLoading:o,retrievingAppointments:c}),e.jsx("div",{className:"w-full h-32 mt-3"})]})});export{k as default};
