import{w as h}from"./with-props-6HJavTuU.js";import{o as e,a as x}from"./chunk-AYJ5UCUI-Bkv6Ioix.js";import{u}from"./GlobalContext-DI10b9EF.js";import{s as f}from"./useStandardizeDate-DE6U8t9S.js";import{s as j}from"./useStandardizeService-C0larYo8.js";import{f as g}from"./useFetchAppointments-DsUODtBA.js";function b({appointment:t}){return e.jsxs("div",{className:"grid grid-cols-7 text-center",children:[e.jsx("p",{children:f(t.appointmentDate)}),e.jsx("p",{children:t.customerEmail||"-"}),e.jsx("p",{children:t.customerName||"-"}),e.jsx("p",{children:t.customerPhone||"-"}),e.jsx("p",{children:t.note||"-"}),e.jsx("p",{children:j(t.service)||"-"}),e.jsx("p",{children:t.hour||"-"})]})}function y({appointments:t,setAppointments:l,getAppointments:o,setLoading:s,retreivingAppointments:n}){return e.jsxs("div",{className:"flex flex-col gap-y-6 mt-4 border border-gray-200 rounded-xl px-4 pt-4 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-7 text-center text-xl font-bold",children:[e.jsx("p",{children:"Дата"}),e.jsx("p",{children:"Имейл"}),e.jsx("p",{children:"Име"}),e.jsx("p",{children:"Телефон"}),e.jsx("p",{children:"Бележка"}),e.jsx("p",{children:"Услуга"}),e.jsx("p",{children:"Час"})]}),e.jsx("div",{className:"overflow-y-auto max-h-128 flex flex-col gap-y-3 border border-gray-200 rounded-xl py-4",children:t&&t.length===0&&!n?e.jsx("div",{className:"w-full h-full z-20 flex justify-center items-center",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"Няма намерени часове"})}):t&&t.length===0&&n?e.jsx("div",{className:"w-full h-full z-20 flex justify-center items-center",children:e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-red-500"})})}):t.map(r=>e.jsx(b,{appointment:r},r.id))}),e.jsxs("div",{className:"w-full h-12",children:[e.jsxs("button",{className:"flex flex-row gap-x-2",children:[e.jsx("p",{className:"text-gray-500 text-sm mt-[-2px] mb-[2px]",children:"Днес"}),e.jsx("input",{type:"checkbox",className:"w-4 h-4 border border-gray-300 rounded-lg",onChange:async r=>{if(!r.target.checked){s(!0),await o(),s(!1);return}const a=new Date,c=t.filter(d=>{const m=new Date(d.appointmentDate);return m.getDate()===a.getDate()&&m.getMonth()===a.getMonth()&&m.getFullYear()===a.getFullYear()});l(c)}})]}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["Общо: ",t.length," поръчки"]})]})]})}function N(t){return[...t].sort((l,o)=>{const s=new Date,n=new Date(l.appointmentDate),r=new Date(o.appointmentDate),i=n.toDateString()===s.toDateString(),a=r.toDateString()===s.toDateString();if(i&&!a)return-1;if(!i&&a)return 1;const c=Math.abs(n.getTime()-s.getTime())-Math.abs(r.getTime()-s.getTime());if(c!==0)return c;const d=l.hour.split(":").map(Number),m=o.hour.split(":").map(Number),p=d[0]*60+d[1];return m[0]*60+m[1]-p})}const T=h(function(){const{setLoading:l,retrievingAppointments:o,setRetrievingAppointments:s}=u(),[n,r]=x.useState([]);x.useEffect(()=>{i()},[]);const i=async()=>{s(!0);const c=(await g()).filter(d=>d.status==="confirmed");r(c),s(!1)};return e.jsxs("div",{className:"w-full h-full font-manrope px-12",children:[e.jsx("p",{className:"text-3xl text-black mt-5 font-semibold",children:"Дашборд"}),e.jsx("div",{className:"w-full h-[2px] bg-gray-100 rounded-full mt-2"}),e.jsx("h1",{className:"text-xl font-semibold mt-2",children:"Поръчки"}),e.jsx(y,{appointments:N(n),setAppointments:r,getAppointments:i,setLoading:l,retrievingAppointments:o}),e.jsx("div",{className:"w-full h-32 mt-3"})]})});export{T as default};
