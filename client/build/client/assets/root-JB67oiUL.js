import{w as p,a as h}from"./with-props-Bh_-DjLQ.js";import{p as f,o as e,a as i,M as g,L as j,S as b,q as w,s as y,O as v}from"./chunk-AYJ5UCUI-DsV8cjzK.js";import{G as k,u as N}from"./GlobalContext-BODhfs1P.js";import{f as A}from"./useFetchAppointments-DsUODtBA.js";import{F as c}from"./firebaseConfig-p6xtbjLt.js";import{F as E,f as S,a as C,b as I,c as R,d as D}from"./index.es-CX5k-t0t.js";import{m as O}from"./proxy-BNWwsI7H.js";const B=({isAdmin:t})=>{const s=f();return e.jsx("div",{className:"w-auto h-full sm:px-[5%] md:px-[10%] pb-3 pt-5 flex items-center font-rubik",children:e.jsxs("div",{className:"flex w-full flex-row justify-between items-center mx-4",children:[e.jsxs("div",{className:"flex flex-row gap-x-3",children:[e.jsx("button",{onClick:()=>{window.open("https://www.adrianenev.com","_blank")},children:e.jsx("div",{className:"w-12 h-12 bg-[#4a6fa5] rounded-full hover:opacity-60"})}),e.jsx("button",{onClick:()=>{s("/")},children:e.jsx("h1",{className:"text-xl sm:text-2xl text-black font-bold hover:opacity-60",children:"Adrian Cuts"})})]}),e.jsxs("div",{className:"flex flex-row gap-x-5",children:[t&&e.jsx("button",{onClick:()=>{s("/admin/dashboard")},children:e.jsx("p",{className:"text-lg text-[#111111] font-medium hover:opacity-60 flex flex-row gap-x-2",children:"Поръчки"})}),e.jsx("button",{className:"w-24 h-10 p-2 rounded-full bg-[#4a6fa5] flex items-center justify-center hover:opacity-70",onClick:()=>{s("/contact")},children:e.jsx("p",{className:"text-base font-medium text-white",children:"Връзка"})})]})]})})},z=async()=>{var s;const t=(s=c.currentUser)==null?void 0:s.uid;if(!t)return!1;try{const n=await fetch(`https://booking-app.fly.dev/api/user/${t}/admin`,{method:"GET"});return n.ok?!!(await n.json()).isAdmin:(console.error("RESPONSE ERROR checking if user is admin:",n),null)}catch(n){return console.error("ERROR checking if user is admin:",n),null}},r=({icon:t,title:s,route:n})=>e.jsxs("button",{className:"flex flex-row items-center gap-x-2 px-2 py-1 ml-[-5px] bg-gray-100 bg-opacity-0 hover:opacity-60",onClick:()=>{n()},children:[e.jsx(E,{icon:t,className:"text-black w-5 h-5"}),e.jsx("p",{className:"text-lg mt-[2px] text-gray-700",children:s})]}),H=()=>{const[t,s]=i.useState(window.innerHeight);i.useEffect(()=>{const o=()=>{s(n())};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[]);const n=()=>window.innerHeight,a=f();return e.jsx("div",{className:"w-full h-full font-manrope",children:e.jsxs("div",{className:"w-full h-full border-r border-gray-200 py-4 mx-2",children:[e.jsx("div",{className:"flex items-start gap-x-5",children:e.jsx("button",{onClick:()=>{a("/")},className:"flex justify-center w-full",children:e.jsx("img",{src:"/images/viktor_cuts_logo.jpg",alt:"logo",className:"w-24 h-24 rounded-full"})})}),e.jsxs("div",{className:"mt-12 flex flex-col gap-y-1",children:[e.jsx(r,{title:"Дашборд",icon:S,route:()=>a("/admin/dashboard")}),e.jsx(r,{title:"Поръчки",icon:C,route:()=>a("/admin/appointments")}),e.jsx(r,{title:"Печалба",icon:I,route:()=>a("/admin/profit")}),e.jsx("p",{className:"text-gray-500 text-sm mt-5",children:"Тест"}),e.jsx(r,{title:"Календар",icon:R,route:()=>a("/booking")}),e.jsx("div",{className:`absolute bottom-4 ${t>=700?"":"hidden"}`,children:e.jsx(r,{title:"Настройки",icon:D,route:()=>a("/account")})})]})]})})},$=async t=>{let s=[],n=t.map(o=>new Date(o.appointmentDate).toISOString().split("T")[0]);const a={};n.forEach(o=>{a[o]=(a[o]||0)+1});for(const o in a)a[o]===12&&(s.push(o),console.log(`Date ${o} has 12 appointments booked.`));return s&&s.length>0?s:[]},M=()=>[{rel:"preconnect",href:"https://fonts.googleapis.com"},{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"},{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"}];function W({children:t}){return e.jsxs("html",{lang:"en",children:[e.jsxs("head",{children:[e.jsx("meta",{charSet:"utf-8"}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),e.jsx(g,{}),e.jsx(j,{})]}),e.jsxs("body",{children:[t,e.jsx(b,{}),e.jsx(w,{})]})]})}const F=async()=>{const t=await A();if(t){localStorage.setItem("bookedAppointments",JSON.stringify(t));const s=await $(t);localStorage.setItem("bookedDays",JSON.stringify(s))}};function L(){const{loading:t,setLoading:s,isAdmin:n,setIsAdmin:a}=N(),[o,d]=i.useState(!1);i.useEffect(()=>{const l=c.onAuthStateChanged(async()=>{F(),await x()});return()=>l()},[]),i.useEffect(()=>{m()},[o]);const m=async()=>{if(await z()){a(!0);return}a(!1)},x=async()=>{var u;if((u=c.currentUser)==null?void 0:u.uid){d(!0);return}d(!1)};return e.jsxs("div",{className:"relative w-screen h-screen overflow-hidden",children:[e.jsx(O.div,{className:"absolute top-0 left-0 w-full h-full z-10 pointer-events-none",animate:{backdropFilter:t?"blur(10px)":"blur(0px)",backgroundColor:t?"rgba(255,255,255,0.2)":"rgba(255,255,255,0)"},transition:{duration:.5},style:{WebkitBackdropFilter:t?"blur(10px)":"blur(0px)"}}),t&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full z-20 flex justify-center items-center",children:e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}),e.jsxs("div",{className:`relative z-0 w-full h-full flex ${n&&o?"flex-row":"flex-col"}`,children:[e.jsx("div",{className:`${n&&o?"w-[14%] h-full":"w-full h-20"}`,children:n&&o?e.jsx(H,{}):e.jsx(B,{isAdmin:n})}),e.jsx("main",{className:`${n&&o?"w-[86%] h-full":"w-full h-full overflow-y-auto"}`,children:e.jsx(v,{})})]})]})}const K=p(function(){return e.jsx(k,{children:e.jsx(L,{})})}),Q=h(function({error:s}){let n="Oops!",a="An unexpected error occurred.",o;return y(s)&&(n=s.status===404?"404":"Error",a=s.status===404?"The requested page could not be found.":s.statusText||a),e.jsxs("main",{className:"pt-16 p-4 container mx-auto",children:[e.jsx("h1",{children:n}),e.jsx("p",{children:a}),o]})});export{Q as ErrorBoundary,W as Layout,K as default,M as links};
